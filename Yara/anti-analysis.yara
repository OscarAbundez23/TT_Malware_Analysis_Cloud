import "elf"

rule CPUID_x86_64_32{
    meta:
        author = "Oscar Abundez"
        description = "Esta regla yara detecta la instrucci√≥n CPUID en arquitectura x86 de 64 o 32 bits"
    strings:
        $p = {0F A2}
    condition:
        for any section in elf.sections:(section.name==".text" and $p and (elf.machine==elf.EM_X86_64 or elf.machine==elf.EM_386))
}