#! /bin/bash

sha256_command=$(which sha256sum)
sha1_command=$(which sha1sum)
md5_command=$(which md5sum)
sha512_command=$(which sha512sum)
ssdeep_command=$(which ssdeep)

if [[ $# -lt 2 ]]; then
  echo "Se requieren 2 par√°metros."
  echo "Uso: $0 <firma_hash> <ruta_malware>"
  exit 2
fi

if [ "$1" = "sha1" ]; then
    $sha1_command $2 | awk '{print $1}'
elif [ "$1" = "sha256" ]
then
    $sha256_command $2 | awk '{print$1}'
elif [ "$1" = "sha512" ]
then
    $sha512_command $2 | awk '{print$1}'
elif [ "$1" = "md5" ]
then
    $md5_command $2 | awk '{print$1}'
elif [ "$1" = "ssdeep" ]
then
    $ssdeep_command $2 | tail -n 1 | awk -F"," '{print$1}'
fi